                                        //---an early foundations selection menu--//                                        var myDoc = app.activeDocument;                                                                                 var fileSep = "/";                                                                                                                 //Where fileSep is "/" you can change it though if you are on windows.                                                        if(File.fs=="Windows")                                                        {                                                             fileSep = "\\";                                                        }                                        ////////////CREATES DIALOG/////////////////////////////////////////////////////////////////////////////////////////////////////                                        var dlgTemplate = app.dialogs.add({name:"Choose the type"});                                        /////////// GETS TAGS NAMES//////////////////////////////////////////////////////////////////////////////////////////////////                                        var dlc1Template  = dlgTemplate.dialogColumns.add();                                        var dlr1Template  = dlc1Template.dialogRows.add();                                        dlr1Template.staticTexts.add({staticLabel:"Types:", minWidth:100});                                        var ddl1Template = dlr1Template.dropdowns.add({minWidth:100});                                         ddl1Template.stringList = ['Creative Expression','Math','Physical Development','Science','Social and Emotional Development','Social Studies'];                                         /////////// DISPLAYS DIALOG//////////////////////////////////////////////////////////////////////////////////////////////////                                        var myTextFrames = myDoc.textFrames.everyItem().getElements();                                        var blnResult;                                        var mySelection;                                        var color = '';                                            blnResult = dlgTemplate.show();                                            mySelection = ddl1Template.stringList[ddl1Template.selectedIndex];                                      //------Colorizing magic!---------------//                                                                             if(blnResult == false){                                            exit();                                        }                                                                            else{                                            myDoc.swatches.itemByName('Default').remove(mySelection);                                            for(t = 0; t < myTextFrames.length; t++){                                                if(myTextFrames[t].label == 'domain'){                                                    myTextFrames[t].contents = mySelection;                                                    //~                                                     myTextFrames[t].insertionPoints[0].appliedParagraphStyle = 'domain';                                                    }                                                if(myTextFrames[t].label == 'domain_icon'){                                                var myWorkFolder = Folder(app.activeScript.parent.fsName+fileSep+'icons');                                                var myFiles = myWorkFolder.getFiles("*.psd");                                                 for(f = 0; f < myFiles.length; f++){                                                //////////////////////////////////////////////////////////////////////////////////////////////////////////                                                var myFileNames = myFiles[f].name.replace('.psd','')                                                //~                                                 alert(toString(myFileNames))                                                var pattern = /\s/g;                                                myNewSelection = mySelection.replace(pattern,'%20')//~                                                 alert(myNewSelection)                                                //~ try{                                                if(myNewSelection == myFileNames){                                                myTextFrames[t].place(File(myFiles[f]));//~                                                 myTextFrames[t].contentType(ContentType.GRAPHIC_TYPE);                                                myTextFrames[t].fit(FitOptions.PROPORTIONALLY)                                                }                                                }                                                }                                                }                                                                                        }                                                                                // Destroy dialog                                        dlgTemplate.destroy();                                                                                