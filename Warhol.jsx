////FILE PREP STUFF///var fileSep = "/";//Where fileSep is "/" you can change it though if you are on windows.if(File.fs=="Windows"){fileSep = "\\";}///GLOBALS///////////////////////////var myDoc = app.activeDocument; var xml = myDoc.xmlElements[0];//////*****MAKES XPATH HAPPY AND COOPERATIVE*****////////////////////////////////////if( !xml.xmlAttributes.itemByName("xmlns:xml").isValid )xml.xmlAttributes.add( "xmlns:xml", "http://www.w3.org/XML/1998/namespace" );if( !xml.xmlAttributes.itemByName("xmlns:aid").isValid )xml.xmlAttributes.add( "xmlns:aid", "http://ns.adobe.com/Adobe InDesign/4.0/" );if( !xml.xmlAttributes.itemByName("xmlns:aid5").isValid )xml.xmlAttributes.add( "xmlns:aid5", "http://ns.adobe.com/Adobe InDesign/5.0/" );/////////////////////////////////////////////////////////////////////////////////////////////  var myTitles = xml.evaluateXPathExpression("//concept/title");var myTextFrames = myDoc.textFrames.everyItem().getElements();var filenameSlicer = /\w+.jpg/var myWorkFolder = Folder(app.activeScript.parent.fsName+fileSep+'icons');var myFiles = myWorkFolder.getFiles("*.jpg"); for(f = 0; f < myFiles.length; f++){//////////////////////////////////////////////////////////////////////////////////////////////////////////var myFileNames = myFiles[f].name.replace('.jpg','');//~ try{for(t = 0; t < myTitles.length; t++){var myIconsName = myTitles[t].parent.xmlAttributes.item('outputclass').value;    if(myFileNames == myIconsName){myTitles[t].xmlContent.insertionPoints[0].contents = '	'myTitles[t].xmlContent.insertionPoints[0].place(File(myFiles[f]));}}}